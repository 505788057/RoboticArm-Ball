"""
:Author:  Vitae
:Create:  2020/7/5 11:14
:Methed:  using the least square method to fit the curve
Copyright (c) 2020, Vitae Group All Rights Reserved.
"""

import matplotlib.pyplot as plt
import numpy as np
import matplotlib as mpl
from mpl_toolkits.mplot3d import Axes3D


def list2array(listx, listy, listz, timelist):
    time = np.array(timelist)
    x = np.array(listx)
    y = np.array(listy)
    z = np.array(listz)

    tem_time = timelist[0] % 10000
    minus_time = timelist[0] - tem_time

    # Least squares
    Least_x = np.polyfit(time - minus_time, x, 1)
    equation_x = np.poly1d(Least_x)
    Least_z = np.polyfit(time - minus_time, z, 1)
    equation_z = np.poly1d(Least_z)
    Least_y = np.polyfit(time - minus_time, y, 2)
    equation_y = np.poly1d(Least_y)

    # or use yvals=np.polyval(z1,x)
    fit_x = equation_x(time - minus_time)
    fit_z = equation_z(time - minus_time)
    fit_y = equation_y(time - minus_time)

    # # 2D
    plot1 = plt.plot(time - minus_time, z, '*', label='original values')
    plot2 = plt.plot(time - minus_time, fit_z, 'r', label='polyfit values')

    plt.xlabel('x axis')
    plt.ylabel('y axis')
    plt.legend(loc=4)  # 指定legend的位置,读者可以自己help它的用法
    plt.title('polyfitting')
    # plt.show()
    plt.savefig('fig.png')

    print('Calidation Fished.')

    # 3D
    # mpl.rcParams['legend.fontsize'] = 10
    # fig = plt.figure()
    # ax = fig.gca(projection='3d')
    # ax.plot(x, z, y, label='parametric curve')
    # ax.plot(fit_x, fit_z, fit_y, label='parametric curve')
    #
    # ax.set_ylabel('Z')
    # ax.set_zlabel('Y')
    # ax.set_xlabel('X')
    # ax.legend()
    # plt.show()


if __name__ == '__main__':
    # transfer them into array
    # tennis1.svo
    # timelist = [1590370805.462524, 1590370805.5231707, 1590370805.5813963, 1590370805.6406145, 1590370805.698655, 1590370805.755522, 1590370805.811019, 1590370805.8673904, 1590370805.9244144, 1590370805.9823272, 1590370806.042043, 1590370806.1024814, 1590370806.1583822, 1590370806.2692547, 1590370806.3247852, 1590370806.382588, 1590370806.438314, 1590370806.4938543, 1590370806.548817, 1590370806.6595979, 1590370806.7155735, 1590370806.7721534]
    # listx = [1.378333568572998, 2.6016061, 2.8438501, 2.8486598, 2.770108222961426, 2.4207764, 2.3422040939331055, 2.324617862701416, 2.1079476, 1.7550919, 1.5248140096664429, 1.2089921236038208, 0.9462942, 0.28882295, 0.16508897, -0.3907056450843811, -0.4709196, -0.9288353, -1.448897123336792, -1.7345365, -2.0495212, -0.8052868843078613]
    # listy = [-0.05165481939911842, -0.26656777, -0.51725614, -0.81832075, -0.9825394153594971, -1.1084504, -1.2568608522415161, -1.479618787765503, -1.5843353, -1.6481928, -1.700961947441101, -1.6539585590362549, -1.6358579, -1.41463, -1.3329362, -1.1728086471557617, -0.9336073, -0.6354038, -0.2573710083961487, 0.43543887, 0.78495455, 0.3775915503501892]
    # listz = np.array([1.4929945468902588, 2.8918116, 3.2883322, 3.6273456, 3.683410167694092, 3.5859275, 3.746155261993408, 3.9522814750671387, 4.021757, 3.9577022, 3.9235706329345703, 3.7479872703552246, 3.6744277, 4.0746527, 4.0460835, 4.078764915466309, 3.984223, 3.8409414, 3.635684013366699, 2.8342047, 2.5602126, 0.8657321929931641])
    # tesnnis2.svo

    listx = [2.9003219604492188, 2.914999, 2.7897768020629883, 2.664806842803955, 2.509872, 2.502492, 2.257084608078003,
             2.12467622756958, 2.026886224746704, 1.8217148, 1.6705565, 1.4125998, 0.7843540906906128,
             0.6815392374992371,
             0.6116997, 0.51989925, 0.4470337927341461, 0.39395439624786377, 0.3130735158920288, 0.23555606603622437,
             0.1817034,
             0.1342813, 0.04152153059840202, -0.08397220075130463, -0.60927105, -0.7687373757362366,
             -0.9387397766113281,
             -1.0574983, -1.0280832, -1.2355990409851074, -1.3635989427566528, -1.3623799]
    listy = [0.43417564034461975, 0.16162421, -0.11754219233989716, -0.38563716411590576, -0.63429135, -0.9109296,
             -1.102527379989624, -1.2968493700027466, -1.4311916828155518, -1.5778172, -1.6967598, -1.7303532,
             -0.9435155391693115, -0.9681894779205322, -0.9778852, -1.0099608, -1.005697250366211, -1.001267910003662,
             -0.9756706953048706, -0.9305459260940552, -0.90242606, -0.8221237, -0.7837788462638855,
             -0.7024073004722595,
             -0.72066426, -0.44028931856155396, -0.14642766118049622, 0.18590547, 0.43050718, 0.7862274050712585,
             1.108873963356018, 1.3778218]
    listz = [3.974457025527954, 4.2234783, 4.310595512390137, 4.331752777099609, 4.395141, 4.5437713, 4.517788887023926,
             4.620116233825684, 4.445725440979004, 4.5253596, 4.4999332, 4.336791, 2.3845386505126953,
             2.364236354827881,
             2.350337, 2.3552065, 2.3541321754455566, 2.387808322906494, 2.365471363067627, 2.3478844165802, 2.3347933,
             2.3187907, 2.2945680618286133, 2.336951732635498, 4.8546853, 4.71743106842041, 4.753421306610107,
             4.6235576,
             4.0115194, 4.3189191818237305, 4.19636344909668, 3.7759159]
    timelist = [1590734852.1242003, 1590734852.1807272, 1590734852.234512, 1590734852.2898612, 1590734852.3444474,
                1590734852.3990796, 1590734852.4539366, 1590734852.508885, 1590734852.564926, 1590734852.6204963,
                1590734852.6761467, 1590734852.730033, 1590734852.7859554, 1590734852.841079, 1590734852.8953316,
                1590734852.9507463, 1590734853.0056183, 1590734853.060884, 1590734853.116235, 1590734853.1715913,
                1590734853.2258458, 1590734853.2809885, 1590734853.3365073, 1590734853.3915794, 1590734853.5579169,
                1590734853.6116655, 1590734853.6685421, 1590734853.723139, 1590734853.7786517, 1590734853.8343437,
                1590734853.8984737, 1590734853.9518814]

    # tennis3.svo
    # listx = [0.3172745, 0.30599847435951233, 0.2955, 0.2935665, 0.28753167390823364, 0.28932345, 0.2934848368167877,
    #          0.296322762966156, 0.2889719307422638, 0.28359633684158325, 0.2756395637989044, 0.25924360752105713,
    #          0.24964043, 0.22924330830574036, 0.21541204, 0.2042052447795868, 0.17592868208885193, 0.16845292,
    #          0.13332465291023254, 0.12662326, 0.11186858266592026, 0.08200584352016449, 0.03798733651638031,
    #          -0.0019563164096325636, -0.010218276, -0.02275446429848671, -0.030307572335004807, -0.06421846151351929,
    #          -0.089726634, -0.09471378, -0.11786812, -0.1374852, -0.1560058444738388, -0.16710165, -0.21381166577339172,
    #          -0.8069354891777039, -1.0064988, -1.2963908910751343, -1.2578022480010986, -1.8013108968734741]
    # listy = [0.5728218, 0.5843399167060852, 0.60232395, 0.60962135, 0.6122140884399414, 0.6264883, 0.6467896103858948,
    #          0.6480776071548462, 0.6529171466827393, 0.6521287560462952, 0.6550891399383545, 0.6397219896316528,
    #          0.5920477, 0.5105807781219482, 0.37324274, 0.2506449818611145, 0.12893235683441162, 0.0034519485,
    #          -0.1891399621963501, -0.32670522, -0.513620913028717, -0.6497299671173096, -0.7802656888961792,
    #          -0.9179131984710693, -0.527315, -0.5445464849472046, -0.5472044944763184, -0.5542003512382507, -0.5442121,
    #          -0.52128863, -0.5026254, -0.4614783, -0.41056010127067566, -0.3533057, -0.2842305302619934,
    #          -0.5402709245681763, -0.15292263, 0.38480105996131897, 0.9864322543144226, 1.2156903743743896]
    # listz = [3.7283587, 3.696535587310791, 3.6984868, 3.6879237, 3.69278883934021, 3.6998756, 3.6971168518066406,
    #          3.6943867206573486, 3.693394184112549, 3.665677070617676, 3.6571907997131348, 3.6156864166259766,
    #          3.5504797, 3.4731931686401367, 3.410746, 3.533870220184326, 3.503570079803467, 3.674098, 4.085834503173828,
    #          3.9624631, 4.301963806152344, 4.330367088317871, 4.097470283508301, 4.188103199005127, 2.422814,
    #          2.327251672744751, 2.2162179946899414, 2.0744686126708984, 1.9716586, 1.8658121, 1.7759119, 1.6916102,
    #          1.5570632219314575, 1.4853101, 1.3855901956558228, 4.590245246887207, 4.931698, 4.860433101654053,
    #          4.329430103302002, 3.885613441467285]
    # timelist = [1590723152.54412, 1590723152.599881, 1590723152.6565528, 1590723152.7145152, 1590723152.7717779,
    #             1590723152.8289044, 1590723152.8841283, 1590723152.9413185, 1590723152.9963236, 1590723153.051572,
    #             1590723153.1083086, 1590723153.1644797, 1590723153.2196696, 1590723153.2749991, 1590723153.3315353,
    #             1590723153.388707, 1590723153.4455416, 1590723153.5003061, 1590723153.5613267, 1590723153.617249,
    #             1590723153.674275, 1590723153.7310069, 1590723153.7860005, 1590723153.8424776, 1590723153.8966901,
    #             1590723153.9523175, 1590723154.0071263, 1590723154.06228, 1590723154.1192317, 1590723154.174128,
    #             1590723154.2299175, 1590723154.2853584, 1590723154.3413773, 1590723154.3956435, 1590723154.4522626,
    #             1590723154.507029, 1590723154.5625625, 1590723154.621313, 1590723154.6772866, 1590723154.7329192]

    list2array(listx, listy, listz, timelist)
